---
layout: post
---

在dockerhub上找到debian/eol镜像。它支持的最老的debian版本是potato，非常小，才44M。

创建容器：

```bash
docker run -it -d --name m3 -v "$PWD/code/mysql-3.23.49/":/root/mysql debian/eol:potato bash
```

进去容器：
```bash
docker exec -it m3 bash
```

进去后安装gcc、g++等，安装后发现gcc版本为2.95，正好是编译mysql-3.23.49推荐的gcc版本。

编译完以后，就根据ref manual来部署就可以。

启动mysql服务器时要注意的地方：

> For versions of MySQL older than 4.0, substitute safe_mysqld for mysqld_safe in the command.

可以把这个容器作为镜像，方便后续需要重建容器：

```bash
docker commit m3 m-3.23.49
```

## innodb配置

```ini
# Uncomment the following if you are using Innobase tables
#innodb_data_file_path = ibdata1:400M
#innodb_data_home_dir = /usr/local/var/
#innodb_log_group_home_dir = /usr/local/var/
#innodb_log_arch_dir = /usr/local/var/
#set-variable = innodb_mirrored_log_groups=1
#set-variable = innodb_log_files_in_group=3
#set-variable = innodb_log_file_size=5M
#set-variable = innodb_log_buffer_size=8M
#innodb_flush_log_at_trx_commit=1
#innodb_log_archive=0
#set-variable = innodb_buffer_pool_size=16M
#set-variable = innodb_additional_mem_pool_size=2M
#set-variable = innodb_file_io_threads=4
#set-variable = innodb_lock_wait_timeout=50
```

启动：

```bash
bin/safe_mysqld --user=mysql &
```

停止：

```bash
bin/mysqladmin -u root shutdown
```
