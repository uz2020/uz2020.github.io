---
layout: post
---

从ER model到relational model，再经过关系代数和sql语句用法，再到实际应用中数据库的用法，再到数据库的存储和索引原理，才到达这一部分：query evaluation。

越走越具技术含量，越走发现这门科学越复杂。我并没有耐心地从头读到尾，而是跳着读。之前读了存储和索引的一部分，现在又差不多忘光了。

随着对数据库查询数据的技术原理的深入了解，就会继续展开很多章节。

1. system catalogs
2. relational operators
3. evaluation algorithms
4. query optimizaiton
5. the space of plans

之后就是数据库的调优了，这也是很多岗位招聘中提到的：熟悉或精通数据库调优。尽管岗位要求如此轻描淡写，我们深知背后要付出很多努力才能达到这个要求。

---
<br />

7.5

这是我的第二次尝试学习数据库原理了。之前读了一些存储和索引的知识，但由于还是离实际应用比较遥远，也没有研读什么源码，突然又有项目做就中断了学习，所以一下子也忘的七七八八了。但怎么说呢，虽然有过中断，但至少现在我了解了一点索引的知识，就不再对索引那么害怕了。还是许式伟说得对，人很容易被事物的外表欺骗，就以为事情很困难。

当我想起十年前我也是在读这本书时，有点感慨时间过得真快。而当时年少的我不能理解课程安排，也是因为自己妄自菲薄，没有好好地读这本书。如今再读，只觉得知识的海洋如此浩瀚。虽然我已经觉得这本书很厚了，但我知道在作者眼里，已经是尽了很大的努力把想说的话压缩在了这本书里。想在一本书里把数据库面面俱到地描述是不现实的。作者做了取舍，他把这门学科的方方面面都点到即止，但是对我来说，却已经是吃不消了。

## relational operators and algorithms

不同算法在不同的场景下性能不同，要考虑的因素：

1. table size
2. existing indexes
3. sort orders
4. size of the available buffer pool
5. buffer replacement policy

ER model设计得不合理时，会出现冗余数据。比如一个信息应该存储在一个entity里，却错误地存在了relationship中。冗余是一定会出问题的，不要抱侥幸心理。无论是在数据库中还是在平时编程中，冗余都会造成问题（当这种冗余的目的不是高可用时）。我之前写的go程序，model文件冗余了，我偷懒没有把它抽离出来，结果一旦有变化就要两头改，搞死人。我参考了nsq的代码，人家的做法是把共同的部分抽出来作为package被调用。
